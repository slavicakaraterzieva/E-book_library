{% extends "layout.html" %}

{% block mytitle %}

{% endblock %}

{% block main %}

<h1 class="mb-5"> Edit Login Details</h1>

<div class="row">
  <!--vertical nav-->
  <nav class="navbar navbar-brand bg-dark col-sm-3 mb-3">

    <div class="container-fluid">
      <!-- Links -->
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link  text-light" href="/account">Your Account</a>
        </li>
        <li class="nav-item">
            <a class="nav-link  text-light" href="/edit_login">Edit Login Details</a>
        </li>
      </ul>
    </div>

  </nav>

  <div class="col-lg-8">
    <p>{{username}} {{type}}</p>

    <form action="/edit_login" method="post">
        <label class="mb-3 alert alert-primary text-center hidden" for="password" id="error_label"></label>
        <input class="form-control mb-2" type="text" id="user_name" name="user_name" value="{{username}}">
        <label for="current_password">Current Password</label>
        <input class="form-control mb-2" type="password" id="current_password" name="current_password">
        <label for="new_password">New Password</label>
        <input class="form-control mb-2" type="password" id="new_password" name="new_password"  onfocusout="validatePassword()">
        <label for="current_password">Confirm Password</label>
        <input class="form-control mb-3" type="password" id="confirm_password" name="confirm_password">
        <button class="btn btn-primary" type="submit">Update Details</button>
      </form>
      <script>
         function validatePassword() {
            var passwordInput = document.getElementById("new_password");
            var password = passwordInput.value;
            var get_class = document.getElementById("error_label")
        // Define the regex pattern for the password
            var passwordPattern = /^(?=.*[A-Za-z])(?=.*[@$!%*#?&])(?=.*\d).{6,}$/;

        // Test if the password matches the pattern
            if (passwordPattern.test(password)) {
                get_class.classList.remove("hidden")
                document.getElementById("error_label").innerHTML = "Password is good";
            } else {
                get_class.classList.remove("hidden")
                document.getElementById("error_label").innerHTML = "Password should be at least 6 characters long and contain at least one uppercase, one lowercase letter, one number and special sign(@$!%*#?&).";
            }
        }
      </script>
  </div>
</div>

{% endblock %}
